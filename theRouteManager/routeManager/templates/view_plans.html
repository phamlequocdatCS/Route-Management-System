{% extends "main/appheader.html" %}
{% load static %}
{% block afterlogin %}

<!-- Page Title -->
<h1 class="mb-3">View Plans</h1>

<!-- Plans Table -->
<table id="planTable" class="table table-striped table-bordered">
    <thead class="thead-dark">
        <tr>
            <th>Plan Name</th>
            <th>Author</th>
            <th>Distance</th>
            <th>Duration</th>
            <th>Status</th>
            <th></th>
        </tr>
    </thead>
    <tbody id="planList">
        <!-- The plans will be populated here by the AJAX call -->
    </tbody>
</table>

<div id="control">
    <div id="viewControl" style="display: none;">
        <button id="saveImage" class="btn btn-primary d-inline-block">Save as Image</button>
        <button id="closeView" class="btn btn-secondary d-inline-block">Close plan view</button>
    </div>
    
    <div id="loading" style="display: none;">
        <img src="{% static 'routeManager/img/spinner.gif' %}" alt="Loading..." style="height: 100%; width: auto; object-fit: contain;" />
        Saving image, please hold...
    </div>
</div>


<div id="container" class="row" style="display: none;">
    <div id="map" class="col-md-9" style="height: 70vh;"></div>
    <div id="info" class="col-md-3 border p-3" style="height: 70vh; overflow: auto;">
    </div>
</div>


<style>
    .custom-badge {
        font-size: 1rem;
        padding: .5em .75em;
    }
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
<script src="https://unpkg.com/leaflet-image@latest/leaflet-image.js"></script>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
    const getLocationName = '{% url "get_location_names" %}';
    const plans = JSON.parse('{{ plans_json|escapejs }}');
    const currentUserRole = "{{ current_user.user_role }}";
</script>

<script src="{% static 'routeManager/js/common.js' %}"></script>
<script src="{% static 'routeManager/js/ajax_common.js' %}"></script>
<script src="{% static 'routeManager/js/view_plans.js' %}"></script>
{% comment %} <script src="{% static 'routeManager/js/html2canvas.js' %}"></script> {% endcomment %}

{% endblock afterlogin %}
